---
title: 开关反转问题
date: 2017-09-22 04:19:25
tags:
categories:
---
```c++
#include <cstdio>
#include <iostream>
#include <cstring>
#include <cmath>
#include <utility>
#include <queue>
#define MAXN 50
#define sc(x) scanf("%d",&(x))

using namespace std;

const int INF = 0x3f3f3f3f;
int a[MAXN][MAXN];
int p[MAXN][MAXN];
int f[MAXN][MAXN][MAXN];
int x[MAXN];
int mark[MAXN];
int M,N;

int gauss(int equ,int vars)
{
	int i=0,j=0;
	memset(mark,0,sizeof(mark));
	for(i=0,j=0; i<equ && j<vars; i++,j++){
		int max_r = i;
		for(int k=i+1; k<equ; k++)
			if(a[k][j]>a[max_r][j])
				max_r = k;
        if(max_r!=i)
            for(int k=0; k<=vars; k++)
                swap(a[i][k],a[max_r][k]);
        if(a[i][j]==0){
            mark[j] = 1;
            i--;	continue;
        }
        for(int k=i+1; k<equ; k++){
            if(a[k][j])
                for(int m=j; m<=vars; m++)
                    a[k][m] = a[k][m]^a[i][m];
        }
	}
	i--;
	for(int k=vars-1; k>=0; k--){
		if(mark[k]){
			x[k] = 1;	continue;
		}
		if(i<0) break;
		int res = 0;
		for(int m=k+1; m<vars; m++)
			res ^= a[i][m]&x[m];
		x[i--] = res;
	}
	return 0;
}

int get(int i,int j,int k)
{
	int ans = f[i][j][k] + f[i-1][j][k] + f[i][j-1][k] + f[i][j+1][k];
	return ans%2;
}

int getans(int i,int j)
{
	int ans = p[i][j] + p[i-1][j] + p[i][j-1] + p[i][j+1];
	return ans%2;
}


int main()
{
	int t;
	sc(t);
	while(t--){
		sc(N),sc(M);
		memset(a,0,sizeof(a));
		memset(p,0,sizeof(p));
		memset(f,0,sizeof(f));
		for(int k=1; k<=M; k++)
		{
			f[1][k][k] = 1;
		}
		for(int i=2; i<=N+1; i++)
			for(int j=1; j<=M; j++)
                for(int k=1; k<=M; k++)
                    f[i][j][k] = get(i-1,j,k);

		for(int i=0; i<M; i++)
			for(int j=0; j<M; j++)
				a[i][j] = f[N+1][i+1][j+1];
		gauss(M,M);
		for(int i=1; i<=M; i++)
			p[1][i] = x[i-1];
		for(int i=2; i<=N; i++)
			for(int j=1; j<=M; j++)
				p[i][j] = getans(i-1,j);
		for(int i=1; i<=N; i++){
			printf("%d",p[i][1]);
			for(int j=2; j<=M; j++)
				printf(" %d",p[i][j]);
			printf("\n");
 	    }
	}
	return 0;
}

```